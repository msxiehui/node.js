var xlsx = require('node-xlsx');var fs = require('fs');//读取文件内容var obj = xlsx.parse(__dirname + '/奇瑞-18.1.3101.xlsx');var excelObj = obj[0].data;//console.log(excelObj);//console.log(excelObj[0]);var sheng = new Array();// for (var i = 0; i < excelObj.length; i++) {for (var i = 0; i < excelObj.length; i++) {    //var sheng={"p":excelObj[i][0],"c":excelObj[i][2]}    sheng.push(excelObj[i][0]);}var sheng = unique5(sheng);// console.log(sheng.length);//声明 城市 var city = new Array();var jingxiao = new Array();for (var i = 0; i < sheng.length; i++) {    city.push(new Array());    jingxiao.push(new Array());   }for (var i = 0; i < excelObj.length; i++) {    var s = excelObj[i][0];    var c = excelObj[i][1];    var num = sheng.indexOf(s);    city[num].push(c);}//数组去重复for (var i = 0; i < city.length; i++) {    city[i] = unique5(city[i]);}//console.log(city);//声明 经销商for (var i = 0; i < city.length; i++) {    for (var j = 0; j < city[i].length; j++) {        jingxiao[i].push(new Array());    }}for (var i = 0; i < excelObj.length; i++) {    var s = excelObj[i][0];    var c = excelObj[i][1];    var x = excelObj[i][2];    var num = sheng.indexOf(s);    var cnum = city[num].indexOf(c);    jingxiao[num][cnum].push(x)   }//console.log(jingxiao)//规则  数组 省   一级数组  [省]//规则  数组 市   一级级数组  [ [市数组] ]//规则  数组 经销商   二级数组  [ [[经销商数组],[经销商数组]],[ [经销商数组] ] ]//规则  数组 车型   三级级数组  [[[[车型数组]]]  省(市(经销商(车型)))var carList=new Array();//声明 车型for (var i = 0; i < jingxiao.length; i++) {    var _list=new Array()    for (var j = 0; j < jingxiao[i].length; j++) {        var _dist=new Array();        for (var k = 0; k < jingxiao[i][j].length; k++) {            //console.log(jingxiao[i][j])            _dist.push(new Array());        }         _list.push(_dist);    }    carList.push(_list);}//console.log(carList)for (var i = 0; i < excelObj.length; i++) {    var s = excelObj[i][0];    var c = excelObj[i][1];    var x = excelObj[i][2];                var num = sheng.indexOf(s);    var cnum = city[num].indexOf(c);    var dnum = jingxiao[num][cnum].indexOf(x);        //console.log(jingxiao[num][cnum]);            var c1= excelObj[i][3];    var c2= excelObj[i][4];    var c3= excelObj[i][5];    var c4= excelObj[i][6];    var c5= excelObj[i][7];    var c6= excelObj[i][8];        var _car=new Array();        c1=="Y" ? _car.push("瑞虎7") : null ;    c2=="Y" ? _car.push("艾瑞泽5") : null ;    c3=="Y" ? _car.push("艾瑞泽7") : null ;    c4=="Y" ? _car.push("瑞虎3") :  null ;    c5=="Y" ? _car.push("瑞虎3x") : null ;    c6=="Y" ? _car.push("瑞虎5x") : null ;    carList[num][cnum][dnum].push(_car);}// {_area:"华南地区",//     Allcity:[//         {//             name:'广东',//             cityList:[//                 {//                     name:'广州市',//                     areaList:['市辖区']//                 }//             ]//         }//     ]// }////        // var citylist = JSON.parse("[]");var citylist = new Array();for (var i = 0; i < sheng.length; i++) {    var s = {};    s["_area"] = sheng[i];    console.log("-----------------------------------------"+i+"--省-->"+ s["p"]);    //var city1 = JSON.parse("[]");    var city1 = new Array();    for (var j = 0; j < city[i].length; j++) {        var c = {};        c["name"] = city[i][j];        console.log(i+":"+j+"------------------------市-->"+ c["name"]);       //  var disk = JSON.parse("[]");        var disk = new Array();        for (var k = 0; k <jingxiao[i][j].length; k++) {            var di = {};            di["name"] = jingxiao[i][j][k];            console.log(i+":"+j+":"+k+":-->" +c["n"]+"--经销商-->"+  di["name"]);                      var cList = new Array();            for (var n = 0; n <carList[i][j][k].length; n++) {                //var car = {};                car = carList[i][j][k][n];                console.log("--车型-->"+ car);                cList=car;            }            di["areaList"]=cList;            disk.push(di);        }        c["cityList"] = disk;        city1.push(c);    }    s["Allcity"] = city1;    citylist.push(s);    //console.log(JSON.stringify(city1));}//console.log(citylist);var jsonDD = {};jsonDD['list'] = citylist;var filename = "qirui.json";fs.writeFileSync(filename, JSON.stringify(jsonDD));function unique5(array) {    var r = [];    for (var i = 0, l = array.length; i < l; i++) {        for (var j = i + 1; j < l; j++)            if (array[i] === array[j]) j = ++i;        r.push(array[i]);    }    return r;}